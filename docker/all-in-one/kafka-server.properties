# Kafka Configuration for t2.micro (1 vCPU, 1GB RAM)
# Optimized for minimal memory and CPU usage

# Server Basics
broker.id=1
listeners=PLAINTEXT://localhost:9092
advertised.listeners=PLAINTEXT://localhost:9092
log.dirs=/app/data/kafka

# Zookeeper
zookeeper.connect=localhost:2181
zookeeper.connection.timeout.ms=18000

# Memory Optimization for t2.micro
num.network.threads=2
num.io.threads=2
socket.send.buffer.bytes=102400
socket.receive.buffer.bytes=102400
socket.request.max.bytes=104857600

# Log Retention (minimize disk usage)
num.partitions=1
default.replication.factor=1
min.insync.replicas=1
log.retention.hours=1
log.retention.bytes=10485760
log.segment.bytes=1073741824
log.retention.check.interval.ms=300000
log.segment.delete.delay.ms=60000

# Single CPU optimization
num.replica.fetchers=1
num.recovery.threads.per.data.dir=1
num.replica.alter.log.dirs.threads=1

# Reduce background threads for single CPU
background.threads=2
log.cleaner.threads=1

# Memory settings
log.flush.interval.messages=1000
log.flush.interval.ms=1000

# Disable unnecessary features
auto.create.topics.enable=true
delete.topic.enable=true
controlled.shutdown.enable=true
controlled.shutdown.max.retries=3
controlled.shutdown.retry.backoff.ms=5000

# JMX (disable for memory savings)
jmx.port=

# Compression
compression.type=snappy
log.compression.type=snappy

# Single partition optimization
offsets.topic.num.partitions=1
offsets.topic.replication.factor=1
transaction.state.log.replication.factor=1
transaction.state.log.min.isr=1

# Reduce timeouts for faster startup
replica.lag.time.max.ms=30000
replica.socket.timeout.ms=30000
replica.socket.receive.buffer.bytes=65536